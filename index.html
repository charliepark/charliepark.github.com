<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Charlie Park’s tumblelog</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* General CSS for the blog */
a { color: inherit; text-decoration: none; }

blockquote {
  border-left: 2px solid #e6e6e6;
  margin: 0;
  padding-left: 1rem;
}

body {
  background-image: url('/images/arrow.webp');
  background-size: 200px 125px;
  background-position: 48.85% -2px;
  background-repeat: no-repeat;
  display: flex;
  flex-direction: column;
  font-family: 'Avenir Next', Avenir, system-ui, -apple-system, sans-serif;
  justify-content: space-between;
  line-height: 1.5;
  margin: 6rem 0 0;
  min-height: 100vh;
}

body.serif {
  font-family: Georgia, 'Times New Roman', Times, serif;
}

button {
  background: hsl(197, 100%, 30%);
  border: none;
  border-radius: 1rem;
  color: hsla(0, 0%, 100%, 0.7);
  font-family: inherit;
  font-size: .85em;
  padding: .075em 1em;
}

code {
  font-family: 'Monaco', monospace;
  font-size: .8em;
  background: #e6e6e6;
  border-radius: 4px;
  padding: 2px 3px;
}
pre code { border: none; padding: 0 }

footer {
  background: #464646;
  color: hsla(0, 0%, 100%, 0.8);
  margin-top: 5rem;
  padding: 1rem;
  text-align: center;
}

h1 { font-size: 2rem; line-height: 1.3; margin-top: 0.25em; }
header h1 { font-size: 4rem; margin-bottom: 0 }
.postbody h1,
.postbody h2,
.postbody h3 { padding-left: 1.2em; text-indent: -1.2em }

h2 { font-size: 1.5rem; margin: 1.5rem 0 0 }

h3 { font-size: 1.2rem; margin: 1.5rem 0 0 }

h4 { font-size: 1rem }

header { text-align: center }

html {
  color: hsla(0, 0%, 0%, 0.9)
}
html.darkmode {
  background: #272727;
  color: hsla(0, 0%, 100%, 0.7);
}

img { max-width: 100% }

main {
  flex-grow: 1;
  margin: 0 auto;
  max-width: 600px;
  width: 100%;
}

nav { padding: 1rem }

strong { font-weight: 600 }

/* Not supported anywhere yet, but in the spec */
p:has(> img) { text-align: center }

.callout_box { background: #ececec; border-radius: .25rem; padding: .5rem 1rem; }
.callout_box p:first-child { margin-top: 0 }
.callout_box p:last-child { margin-bottom: 0 }

.gray { color: #545454 }

.postbody { padding: 20px }
nav a, .postbody a { border-bottom: 1px solid #e6e6e6; color: hsl(197, 100%, 30%); font-weight: 600; text-decoration: none }
nav a { margin: .5rem }
.postbody a:hover { border-color: #c6c6c6 }

.smallcaps, .postdate, .poem h1 + p {
  font-size: .75em;
  letter-spacing: .8px;
  text-transform: uppercase;
}

.postdate {
  border-bottom: 1px solid #e6e6e6;
  display: block;
  margin-top: 4rem;
  text-align: right;
}
.postdate a { color: #545454; display: block; padding: 0 1rem }

/* Post-specific CSS */

.image { text-align: center }
.image img { margin-bottom: 1rem }
.image p { margin: 0 }

.poem .postbody{
  align-items: center;
  display: flex;
  flex-direction: column;
}
.poem h1 { margin-bottom: 0 }

.text {}

.quote .postbody { font-size: 2rem; }
.quote.long .postbody { font-size: 1.5rem; }
.quote.short .postbody { font-size: 3rem; line-height: 1.3 }
.quote.verylong .postbody { font-size: 1rem; }
.quote p { padding-left: 2rem }
.quote p:first-child { padding-left: 2rem; position: relative;}
.quote p:first-child::before { content: '“'; font-family: Georgia; font-size: 4rem; line-height: 3rem; position: absolute; top: 10px; left: 0; }
.quote p:last-child { font-size: 1rem; text-align: right }

.video iframe { width: 100% !important }



/* Minified code styling; https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css  */
code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:0 0;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
  </style>
</head>
<body>
  <header>
    <h1><a href="/">Charlie Park!</a></h1>
    <div>(or, rather, his tumblelog)</div>
    <nav><a href="/">home</a><a href="/about">about me</a><a href="/projects">projects</a></nav>
  </header>
  <main>
    <article class="text">
  <time class="postdate" datetime="2020-10-05T07:00:00.000Z">
    <a href="/smartquotes_in_eleventy/">October 5, 2020</a>
  </time>
  <div class="postbody">
    <h1>Smartquotes in Eleventy</h1>
<aside style="background:#e5e5e5; border-radius: 1rem; padding: 1px 1rem;">
<p>This post will make a bit more sense if you read it in a serif font. You can do that by poking this button: <button id="serif_toggle">serif / sans</button></p>
</aside>
<script>
  const serifToggle = document.getElementById("serif_toggle");
  console.log(serifToggle);
  serifToggle.addEventListener("click", () => {
    console.log("clicked");
    document.body.classList.toggle("serif");
  });
</script>
<p>I’m working on turning this tumblelog into a more fully-fleshed-out tool that anyone can use to quickly spin up a tumblelog of their own, and one of the things I wanted to nail down was smartquotes.</p>
<p>So far, I’ve gone to the trouble of hand-typing all of the smartquotes in my posts. How nice would it be, though, if Eleventy could just <em>know</em> which quote to put down, and do it for you?</p>
<p>Before I get into that, a quick bit of background for those of you who aren’t typography nerds. As a caveat, I use the Nunjucks templating syntax, and this all works; if you try it in another templating framework, let me know how it goes.)</p>
<h2>Smart whatnow?</h2>
<p>So if you look on your keyboard, just to the left of your “return” key, you’ll see the key you’d press to add a single quotation mark (’) or, with the <code>Shift</code> key modifying it, a double quotation mark (”).</p>
<p>In programs like Google Docs, the software typically converts those into “smart” (or “curly”) quotes for you. Smart quotes are the traditional way you’d see quotes when set in type, like in a book, magazine, etc.</p>
<p>There’s a problem, though! By default, Eleventy doesn’t change your quotes in Markdown files to smartquotes. So, unless you wrote each quotation mark in manually (<code>option</code> + <code>[</code> for left double quote, <code>shift</code> + <code>option</code> + <code>[</code> for right double quote, plus a similar process for apostrophes), you’d be left with straight quotes.</p>
<p>I haven’t <em>minded</em> hand-writing them, but surely there’s an easier way?</p>
<h1>Horrors. How do we fix it?</h1>
<p>Thankfully, Eleventy lets us run custom filters, which can process the files we’re saving. We just have to create one that does what we want.</p>
<p>In our <code>.eleventy.js</code> file, we’ll add a new filter, called “smartquotes”. Before we add anything in, it looks like this:</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token keyword">return</span> post<span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre>
<p>And we’ll call it in our main template file (like <code>index.njk</code>) like this:</p>
<pre class="language-js"><code class="language-js"><span class="token operator">&lt;</span>main<span class="token operator">></span><br>  <span class="token punctuation">{</span><span class="token punctuation">{</span> content <span class="token operator">|</span> smartquotes <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br><span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">></span><br></code></pre>
<p>(Normally, it’d just say <code>content | safe</code>, without the <code>smartquotes</code> bit in the middle.)</p>
<p>Okay. Now we basically need to add some regular expressions to swap out our various quotation marks.</p>
<h3>Regular double quotes</h3>
<p>Nunjucks converts normal double quotes (that aren’t inside a <code>&lt;code&gt;</code> block) into <code>&amp;quot;</code>, so we’re going to want to add a find-and-replace regular expression looking for that string.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|^|>)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If you aren’t familiar with regular expressions, that syntax can look kind of strange. Here’s what it means:</p>
<p><code>(\s|&gt;|^)&amp;quot;</code> = Look for the string <code>&amp;quot;</code> preceded by either a whitespace character or an angle bracket, or that’s at the beginning of the line. We need the angle bracket one in there because even if the quote mark is at the beginning of the line as we read it, the code behind the scenes kicks the line off with a <code>&lt;p&gt;</code> or similar.</p>
<p>The second one — <code>&amp;quot;(\s|\p{P}|$)?</code> — is kind of the opposite. Find situations where <code>$quot;</code> is followed by a whitespace character or by a punctuation mark of some sort, or is at the end of its line. That <code>\p{P}</code> is the “punctuation” wildcard. Note that you need to add the <code>u</code> flag at the end of the regular expression (to the right of the second slash, after the <code>g</code>).</p>
<p>Okay, great. What do we do with those two <code>const</code>s?</p>
<p>We add them in to the return statement, calling <code>replace()</code> on the <code>post</code> string:</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> post<br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openDoubles<span class="token punctuation">,</span> <span class="token string">"$1“"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeDoubles<span class="token punctuation">,</span> <span class="token string">"”$1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>The <code>$1</code> in that <code>replace()</code> string is for <em>capture groups</em> in the regular expression. Note how the regular expressions looked like <code>(\s|&gt;|^)&amp;quot;</code>? The part inside the parentheses is what gets popped into the <code>$1</code> in the <code>replace()</code> parameter.</p>
<p>Okay, so! We got our double quotes taken care of.</p>
<h3>Regular single quotes</h3>
<p>Like the double quotes, we’ll need to put together some regular expressions to get the single quotes.</p>
<p>This should look familiar:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> openSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)'/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> closeSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(\s|\p{P}|$)?/g</span><span class="token punctuation">)</span>u<span class="token punctuation">;</span></code></pre>
<p>See if you can read through that line and figure out what each one does. If you need help, look up at the section before this.</p>
<p>The only difference on the <code>replace()</code> call is that we’ll use smart single quotes:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openSingles<span class="token punctuation">,</span> <span class="token string">"$1‘"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeSingles<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span></code></pre>
<p>So now our full filter looks like this:</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)'/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> post<br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openDoubles<span class="token punctuation">,</span> <span class="token string">"$1“"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeDoubles<span class="token punctuation">,</span> <span class="token string">"”$1"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openSingles<span class="token punctuation">,</span> <span class="token string">"$1‘"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeSingles<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Okay, great. So that’s single and double quotes. We haven’t gotten apostrophes set, yet. Let’s do that next.</p>
<h3>Apostrophes</h3>
<p>Apostrophes are pretty straightforward. A “word boundary” (0-9, a-z, A-Z, or the underscore character), then an apostrophe, then another “word boundary”. Things like can’t, they’re, it’s, and so on.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> apostrophes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\b)'(\b)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Note the parentheses, which let us capture the values and drop them into our <code>replace()</code> function.</p>
<p>As before, we keep building up our string manipulation:</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> apostrophes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\b)'(\b)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)'/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> post<br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>apostrophes<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openDoubles<span class="token punctuation">,</span> <span class="token string">"$1“"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeDoubles<span class="token punctuation">,</span> <span class="token string">"”$1"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openSingles<span class="token punctuation">,</span> <span class="token string">"$1‘"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeSingles<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Are we good, then?</p>
<p>Haha, no, you sweet, summer child.</p>
<h3>Abbreviated years</h3>
<p>Believe it or not, the apostrophe in shortened years is supposed to point to the left. That is, the “pointy bit” of the quotation mark always points to the thing that got removed. So if you shorten “2020”, you’d want it to look like ’20, not ‘20.</p>
<p>So how do we do that?</p>
<p>Just like the apostrophes, we capture some values. This time we capture a single quote sandwiched between a whitespace character and a digit.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> years <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s)'(\d)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>years<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span></code></pre>
<p>And, at the risk of being repetitive, here’s what our <code>smartquotes</code> filter looks like at this point:</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> apostrophes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\b)'(\b)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> years <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s)'(\d)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)'/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> post<br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>apostrophes<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>years<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openDoubles<span class="token punctuation">,</span> <span class="token string">"$1“"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeDoubles<span class="token punctuation">,</span> <span class="token string">"”$1"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openSingles<span class="token punctuation">,</span> <span class="token string">"$1‘"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeSingles<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Okay, great! Surely there aren’t any edge cases?</p>
<p>Oh, but there are.</p>
<h3>Edge cases — slang and Hawaiʻi</h3>
<p>As we just saw in <code>years</code>, the “pointy bit” of the quotation mark points at the elided content.</p>
<p>When “them” gets cut down to “em”, or “it was” gets smushed into “twas”, we want the quotation marks pointing at the beginning of the word: ’cause, ’em, ’til, ’twas.</p>
<p>Fortunately, there aren’t <em>that</em> many special cases, so for now I’ve hardcoded them. Odds are good I’ve missed a few. Please feel free to ping me and let me know!</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> slang <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(cause|em|til|twas)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>We also have an interesting case where — in the Hawaiian language — the official name of their land is Hawaiʻi. The character in between the two <code>i</code>s is called an ‘okina, and it’s a diacritic that indicates a glottal stop. When writing an ‘okina, the “pointy bit” points up — instead of down — regardless of where it occurs in a word. (<a href="https://en.wikipedia.org/wiki/Hawaii#Etymology">You can read more on the ‘okina over at Wikipedia.</a>)</p>
<p>The ‘okina is technically present in many Hawaiian words, like Oʻahu or Kauaʻi. My assumption, though, is that if you are paying attention to ‘okinas, you’re going to be hardcoding them in anyway. This filter catches Hawaiʻi, but doesn’t attempt to catch all Hawaiian words with ‘okinas.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> hawaii <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/Hawai'i/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Okay, so where are we now?</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> hawaii <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/Hawai'i/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> slang <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(cause|em|til|twas)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> apostrophes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\b)'(\b)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> years <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s)'(\d)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> openSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)'/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> closeSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> post<br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>hawaii<span class="token punctuation">,</span> <span class="token string">"Hawaiʻi"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>slang<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>apostrophes<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>years<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openDoubles<span class="token punctuation">,</span> <span class="token string">"$1“"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeDoubles<span class="token punctuation">,</span> <span class="token string">"”$1"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openSingles<span class="token punctuation">,</span> <span class="token string">"$1‘"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeSingles<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>That’s basically it! Almost.</p>
<h3>A hack for stet quotes</h3>
<p>The one last thing I ran into when working up this filter was kind of meta: When writing about it on this blog, how do we prevent straight quotes in code blocks (like the one right above this) from getting switched to smart quotes?</p>
<p>There were two ways I could think of to approach this situation. One was to create a more complicated regex that involved some sort of multi-line lookbehind, which would probably be pretty fragile. The other was to create some sort of rule to make sure that — at the end of the filtering — some quotes could stay as straight quotes. I went with that one. (If you have other suggestions, I’m all ears!)</p>
<p>In the journalism world, when editing on paper, <code>stet</code> is the markup an editor uses that means “um, I suggested a change, but you should ignore that, and keep your copy as it is.” As in, I’m editing your newspaper article and I cross out a word, and then decide that the word was actually appropriate, I’d write “stet” next to my earlier edit.</p>
<p>We need a “stet” equivalent here.</p>
<p>Here it is.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> stetSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/stet'stet/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And, in the filter, we’ll call it with this:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>stetSingles<span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Note how there are no capture groups in the regex. So if I’m writing a block of code in Markdown (like I’m doing in this post), and I want to make sure it renders with a straight quote, I wrap it in the literal text <code>stet</code>. So if I write <code>stet'stetthisstet'stet</code>, what gets rendered is <code>'this'</code> instead of <code>‘this’</code>.</p>
<p>That’s probably a little hard to read. But what it’s saying is that when the entire filter runs, the very last call will be to look for text in the post that has a <code>stet</code> followed by a <code>’</code> followed by a <code>stet</code>, and to change that whole string into a straightquote.</p>
<p>And with that, for now, we’ve got our filter.</p>
<h2>The final filter</h2>
<p>Here’s what goes in your .eleventy.js file:</p>
<pre class="language-js"><code class="language-js">  eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"smartquotes"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> hawaii <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/Hawai'i/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> slang <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(cause|em|til|twas)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> apostrophes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\b)'(\b)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> years <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s)'(\d)/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> openDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)&amp;quot;/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> closeDoubles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/&amp;quot;(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> openSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/(\s|>|^)'/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> closeSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/'(\s|\p{P}|$)?/gu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> stetSingles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/stet'stet/g</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> post<br>      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>hawaii<span class="token punctuation">,</span> <span class="token string">"Hawaiʻi"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>slang<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>apostrophes<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>years<span class="token punctuation">,</span> <span class="token string">"$1’$2"</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openDoubles<span class="token punctuation">,</span> <span class="token string">"$1“"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeDoubles<span class="token punctuation">,</span> <span class="token string">"”$1"</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>openSingles<span class="token punctuation">,</span> <span class="token string">"$1‘"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>closeSingles<span class="token punctuation">,</span> <span class="token string">"’$1"</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>stetSingles<span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And, then, like I said before, the “content” part of your <code>index.njk</code> file should look like this:</p>
<pre class="language-js"><code class="language-js"><span class="token operator">&lt;</span>main<span class="token operator">></span><br>  <span class="token punctuation">{</span><span class="token punctuation">{</span> content <span class="token operator">|</span> smartquotes <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br><span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">></span><br></code></pre>
<h2>A few tests:</h2>
<p>Abbreviated years work: ’97, ’01, ’04, ’07.</p>
<p>Apostrophes and contractions work: I can’t wait to see if anyone uses this.</p>
<p>Quotes work: “I just don’t think I have it in me,” said the dog that definitely didn’t eat the bacon off the countertop, no siree.</p>
<p>Internal quotes work, even with odd punctuation: “She didn’t say ‘You did this’! She said ‘<em>Hugh</em> did this’!”</p>
<p>Oh, and thanks to how Nunjucks and Eleventy process HTML, if we have some hardcoded HTML with a class or an inline style — <span style="color: darkred; font-family: fantasy">like this one</span> — the quote marks inside the brackets won’t get messed up, and your HTML will still work as expected.</p>
<p>Quotes at the beginning of a line will work, too:<br>
“And your profession?” “Goodness.”</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-10-04T07:00:00.000Z">
    <a href="/json_feeds/">October 4, 2020</a>
  </time>
  <div class="postbody">
    <h1>JSON Feeds in Eleventy</h1>
<p>I’ve wanted to set up an RSS/JSON feed for this tumblelog for a little bit, but hadn’t made the time. I just took care of it, and it was really straightforward.</p>
<p>I started with <a href="https://piccalil.li/quick-tip/create-a-json-feed-with-11ty/">Andy Bell’s quick intro on making a JSON Feed in Eleventy</a>, but then made some modifications to help it conform more to <a href="https://jsonfeed.org/">the JSON Feed spec</a>.</p>
<p>Here’s what I ended up with, in a file called <code>feed.njk</code> in my root directory:</p>
<pre class="language-js"><code class="language-js"><span class="token operator">--</span><span class="token operator">-</span><br>permalink<span class="token operator">:</span> <span class="token string">"/feed.json"</span><br><span class="token operator">--</span><span class="token operator">-</span><br><span class="token punctuation">{</span><br>  <span class="token string">"version"</span><span class="token operator">:</span> <span class="token string">"https://jsonfeed.org/version/1.1"</span><span class="token punctuation">,</span><br>  <span class="token string">"title"</span><span class="token operator">:</span> <span class="token string">"Charlie Park!"</span><span class="token punctuation">,</span><br>  <span class="token string">"home_page_url"</span><span class="token operator">:</span> <span class="token string">"https://charliepark.org/"</span><span class="token punctuation">,</span><br>  <span class="token string">"feed_url"</span><span class="token operator">:</span> <span class="token string">"https://charliepark.org/feed.json"</span><span class="token punctuation">,</span><br>  <span class="token string">"icon"</span><span class="token operator">:</span> <span class="token string">"https://charliepark.org/images/arrow_for_feed.jpg"</span><span class="token punctuation">,</span><br>  <span class="token string">"favicon"</span><span class="token operator">:</span> <span class="token string">"https://charliepark.org/favicon.ico"</span><span class="token punctuation">,</span><br>  <span class="token string">"language"</span><span class="token operator">:</span> <span class="token string">"en-US"</span><span class="token punctuation">,</span><br>  <span class="token string">"items"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> collections<span class="token punctuation">.</span>post <span class="token operator">|</span> reverse <span class="token operator">%</span><span class="token punctuation">}</span><br>    <span class="token punctuation">{</span><br>      <span class="token string">"id"</span><span class="token operator">:</span> <span class="token string">"https://charliepark.org{{ item.url }}"</span><span class="token punctuation">,</span><br>      <span class="token string">"url"</span><span class="token operator">:</span> <span class="token string">"https://charliepark.org{{ item.url }}"</span><span class="token punctuation">,</span><br>      <span class="token string">"title"</span><span class="token operator">:</span> <span class="token string">"{{ item.data.type }}: {{ item.url }}"</span><span class="token punctuation">,</span><br>      <span class="token string">"content_html"</span><span class="token operator">:</span> <span class="token string">"{{ item.templateContent | replace('"</span>'<span class="token punctuation">,</span> <span class="token string">"\""</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"\\\\"</span><span class="token punctuation">)</span> <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span>"<br>    <span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> not loop<span class="token punctuation">.</span>last <span class="token operator">%</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span><br>  <span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><br><span class="token punctuation">}</span><br></code></pre>
<p>That string of <code>replace()</code>s in the last line of the for loop is to handle some string transformations so that the post content better functions with the JSON spec. Since I use smart quotes in my posts, it won’t mess up my quotation marks. Just be aware that you might need to keep an eye out on those.</p>

  </div>
</article><article class="image">
  <time class="postdate" datetime="2020-10-03T07:00:00.000Z">
    <a href="/fern/">October 3, 2020</a>
  </time>
  <div class="postbody">
    <p><img src="/images/fern.jpg" alt="Our dog, Fern, looking noble."></p>
<p>Fern is a very good girl.</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-10-01T07:00:00.000Z">
    <a href="/tutorials_over_libraries/">October 1, 2020</a>
  </time>
  <div class="postbody">
    <h1>Tutorials Over Libraries</h1>
<p>Andy Bell published a new tutorial today, on <a href="https://piccalil.li/tutorial/build-a-responsive-media-browser-with-css/">how to build a responsive media browser with CSS</a>. It’s a great runthrough of how he did it, and I especially like his 16:9 aspect ratio trick for the media object. It’s clever, while still being clear — a line that’s surprisingly hard for many developers to walk. And Andy does a great job talking through some of the reasoning behind different decisions, like some choices he made in the service of universal design.</p>
<p>So the article’s great, but what I really want to write about here is how much I appreciate that he wrote it up as a <em>tutorial</em> and not as a <em>library</em>.</p>
<p>An aspect of “the old web” that I miss is people writing up how they solved different technical challenges. I’m guilty of this, too. To be sure, people still do write things up, but it seems like it’s far more common for people to create a JavaScript module and to release it on NPM these days. “Hey, world. Here’s a ready-to-go responsive media browser! I’ve hidden the complicated parts so you don’t need to worry about them.”</p>
<p>Matthew Crawford — motorcycle mechanic and philosophy/sociology research fellow at UVA — talks about this principle (and how damaging it can be) a fair amount in his book <em>Shop Class As Soul Craft</em>. In his case, he talks about the evolution of the dipstick in the car. When cars first came out, you couldn’t own one unless you knew how the internal parts worked together. Over time, car mechanics began to take on that work, and car owners only needed to check their engine oil level every once in a while. Then came the “check engine” light. Later, the OBD-II monitor, which required not only specialized knowledge, but specialized hardware and software. Ultimately, some cars didn’t even have a dipstick accessible to the owner, and it could only be serviced by taking it in to the dealer. (Rent-seeking isn’t only present in the SaaS world.)</p>
<p><em>Yes</em>, being freed from having to deal with “the complicated parts” meant that people were freed to do other (presumably more valuable) things with their time. And there’s something to be said for an external library that’s properly tested versus your own homespun version. But that external reliance comes at a cost of knowing your own tools and honing your craft. Of understanding the bespoke decisions that go into developing the particular thing you’re making, and of learning about both common pitfalls and edge cases to account for. Of knowing how to fix things when the externally-provided library doesn’t work any longer.</p>
<p>So I think there’s a lot to be said for getting your hands dirty and — yes — duplicating work that others have done.</p>
<p>Tutorials, like the one that Andy wrote, are one of the best things about the web, and are so much richer than a comparable package/module/component. I’d love to see more people writing up their processes, and showing off how they build things. And, ultimately, showing the rest of us how we, too, can build something similar.</p>

  </div>
</article><article class="quote long">
  <time class="postdate" datetime="2020-10-01T07:00:00.000Z">
    <a href="/make_that_dream_a_reality/">October 1, 2020</a>
  </time>
  <div class="postbody">
    <p>Think of all the time and energy we all must presently devote to the outbursts driven by Trump’s bottomless appetite for attention. Imagine having that psychic burden lifted. Envision the name Trump appearing only in the headlines of below-the-fold stories about criminal investigations and civil lawsuits. Now vote, and make that dream a reality.</p>
<p>Eugene Robinson — <a href="https://www.washingtonpost.com/opinions/imagine-what-it-will-be-like-to-never-have-to-think-about-trump-again/2020/10/01/d0b32de0-0413-11eb-a2db-417cddf4816a_story.html?utm_source=rss&amp;utm_medium=referral&amp;utm_campaign=wp_opinions">Imagine what it will be like to never have to think about Trump again</a></p>

  </div>
</article><article class="video">
  <time class="postdate" datetime="2020-09-30T07:00:00.000Z">
    <a href="/america_is_doomed_the_musical/">September 30, 2020</a>
  </time>
  <div class="postbody">
    <iframe title="New York Times Video - Embed Player" width="480" height="321" frameborder="0" scrolling="no" allowfullscreen="true" marginheight="0" marginwidth="0" id="nyt_video_player" src="https://www.nytimes.com/video/players/offsite/index.html?videoId=100000007370133"></iframe>
<p>Was just wondering last week about the Gregory Brothers and what they’re up to these days. Here we go.</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-28T07:00:00.000Z">
    <a href="/voting_cheatsheet/">September 28, 2020</a>
  </time>
  <div class="postbody">
    <h1>SF Voting Cheatsheet</h1>
<p>I’m a big fan of <a href="http://www.theleaguesf.org">The League of Pissed Off Voters</a> and the guides they make each year. They have a more comprehensive guide on the way, but they’ve posted a <a href="http://www.theleaguesf.org/november_2020_cheat_sheet">cheatsheet</a> in case you’re voting early.</p>
<p>I look forward to their more nuanced writeups on some of the propositions, but it’s good to have a general sense of their positions. I’m really hoping folks in District 1 pay attention and vote for <a href="conniechansf.com/">Connie Chan</a>.</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-27T07:00:00.000Z">
    <a href="/coaching/">September 27, 2020</a>
  </time>
  <div class="postbody">
    <h1>Get You a Coach for Great Good!</h1>
<p>So I’ve benefitted greatly from working with a therapist over the last year. (<a href="https://www.golodner.com/">This is mine.</a>) He asks great questions, has helped me better understand both myself and my relationships, and has helped me train my ability to get work done more effectively. I highly recommend working with a therapist or coach if you can.</p>
<p>A good friend of mine is also an excellent coach, and has recently opened up a few slots for new clients. If you’re interested, she’ll give you a free session to see if you click. You can check her out and sign up for a free session here: <a href="https://www.lane.coach/">Coaching With Lane</a>. It’s kind of incredible how insightful she is, and how quickly she picks up on little things you say / don’t say, and follows up with just the right amount of curiosity to make you pause, reflect, and open a new door of understanding. It’s pretty wild, to be honest.</p>
<p>If you’ve been thinking about finding a coach, but have been waiting for a sign, consider this the sign and check out her coaching. There are few uses of your precious time that’ll be more useful than reaching out to see if she can help you get unstuck.</p>

  </div>
</article><article class="quote short">
  <time class="postdate" datetime="2020-09-26T07:00:00.000Z">
    <a href="/no_place_on_earth/">September 26, 2020</a>
  </time>
  <div class="postbody">
    <p>There is no place on earth so beautiful as Tamalpaias.</p>
<p>Robert Louis Stevenson, from the top of Mount Tam</p>

  </div>
</article><article class="image">
  <time class="postdate" datetime="2020-09-25T07:00:00.000Z">
    <a href="/twilight_in_the_wilderness/">September 25, 2020</a>
  </time>
  <div class="postbody">
    <p><img src="/images/twilight_in_the_wilderness.jpg" alt="A painting of a sun setting over a river, with a mountain in the distance. The clouds are illuminated in reds and blues."></p>
<p>Frederic Edwin Church — <em>Twilight in the Wilderness</em></p>

  </div>
</article><article class="quote verylong">
  <time class="postdate" datetime="2020-09-25T07:00:00.000Z">
    <a href="/the_machine/">September 25, 2020</a>
  </time>
  <div class="postbody">
    <p>In the first chapter, a disagreement develops between the narrator and his riding companions, John and Sylvia, over the question of motorcycle maintenance. Robert performs his own maintenance, while John and Sylvia insist on having a professional do it. This posture of non-involvement, we soon learn, is a crucial element of their countercultural sensibility. They seek escape from “the whole organized bit” or “the system,” as the couple puts it; technology is a death force, and the point of hitting the road is to leave it behind. The solution, or rather evasion, that John and Sylvia hit on for managing their revulsion at technology is to “Have it somewhere else. Don’t have it here.” The irony is they still find themselves entangled with The Machine—the one they sit on.</p>
<p>Today, we often use “technology” to refer to systems whose inner workings are assiduously kept out of view, magical devices that offer no apparent friction between the self and the world, no need to master the grubby details of their operation. The manufacture of our smartphones, the algorithms that guide our digital experiences from the cloud—it all takes place “somewhere else,” just as John and Sylvia wished.</p>
<p>Yet lately we have begun to realize that this very opacity has opened new avenues of surveillance and manipulation. Big Tech now orders everyday life more deeply than John and Sylvia imagined in their techno-dystopian nightmare. Today, a road trip to “get away from it all” would depend on GPS, and would prompt digital ads tailored to our destination. The whole excursion would be mined for behavioral data and used to nudge us into profitable channels, likely without our even knowing it.</p>
<p>Matthew Crawford, <em><a href="https://www.smithsonianmag.com/smithsonian-institution/robert-pirsig-zen-art-motorcycle-maintenance-resonates-today-180975768/">Why Robert Pirsig’s ‘Zen and the Art of Motorcycle Maintenance’ Still Resonates Today</a></em></p>

  </div>
</article><article class="quote long">
  <time class="postdate" datetime="2020-09-24T07:00:00.000Z">
    <a href="/he_will_never_concede/">September 24, 2020</a>
  </time>
  <div class="postbody">
    <p>Let us not hedge about one thing. Donald Trump may win or lose, but he will never concede. Not under any circumstance. Not during the Interregnum and not afterward. If compelled in the end to vacate his office, Trump will insist from exile, as long as he draws breath, that the contest was rigged.</p>
<p>Trump’s invincible commitment to this stance will be the most important fact about the coming Interregnum. It will deform the proceedings from beginning to end. We have not experienced anything like it before.</p>
<p><a href="https://www.theatlantic.com/magazine/archive/2020/11/what-if-trump-refuses-concede/616424/">The Election That Could Break America</a></p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-23T07:00:00.000Z">
    <a href="/mackenzie_time_inventory/">September 23, 2020</a>
  </time>
  <div class="postbody">
    <h1>The Mackenzie Time Inventory</h1>
<p>In the management classic <em>The Time Trap</em>, R. Alec Mackenzie has several solid recommendations, including getting a sense of where your time goes. He recommends creating and using a time inventory:</p>
<blockquote>
<p>From the earliest efforts to log their time, executives have found that their time allotments were not going where they thought they were. …</p>
<p>Peter Drucker’s remarks about the time log are enlightening. He observes that approaches to getting more work done always begin with planning. However, effective executives do not start this way. They know that if you start with a plan, it ends up in the bottom drawer. Other plans will follow, winding up in the same place. Instead, according to Drucker, <strong>the astute executive begins by finding out where [their] time is really going.</strong></p>
<p>The time inventory, or log, is necessary because <strong>the painful task of changing our habits requires far more conviction than we can build from learning about the experience of others.</strong> We need the amazing revelation of the great portions of time we are wasting to provide the determination to manage ourselves more effectively in this respect.</p>
</blockquote>
<p>In the book, Mackenzie lays out a chart that you can use to log your time. It wasn’t a bad layout for 1972, but as we have some more tools at our disposal, I figured it’d make for a solid spreadsheet.</p>
<p>So! I made one, using Google Sheets. If you’re interested, you can copy (and use) <a href="https://docs.google.com/spreadsheets/d/1fpmrTxIEv4ZF6kVMSo4OJbWVefulFR-vcgQ2IbcSSk8/edit?usp=sharing">The Mackenzie Time Inventory</a>.</p>
<p>Let me know if you use it, and how it could be improved!</p>

  </div>
</article><article class="quote">
  <time class="postdate" datetime="2020-09-22T07:00:00.000Z">
    <a href="/the_right_thing/">September 22, 2020</a>
  </time>
  <div class="postbody">
    <p>If doing the right thing were always easy, there wouldn’t be so many people doing the wrong things. Doing the right thing even when it has negative personal consequences is the mark of good character.</p>
<p><a href="https://www.reddit.com/r/relationship_advice/comments/ixplv5/updatemy26m_brother29m_is_married_to_and_cheating/g685sh7/">jimmyjrdanceparty</a></p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-22T07:00:00.000Z">
    <a href="/the_has_selector/">September 22, 2020</a>
  </time>
  <div class="postbody">
    <p>No browsers support it yet, but there’s a useful pseudo-class in the CSS spec that I just stumbled on: <code>:has()</code></p>
<p>Say you have a style that applies to links, but you don’t want it to apply to links when they contain an image (like an image that links to a gallery). You could do something like this:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">a</span> <span class="token punctuation">{</span> <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #000 <span class="token punctuation">}</span><br><span class="token selector">a:has(img)</span> <span class="token punctuation">{</span> <span class="token property">border</span><span class="token punctuation">:</span> none <span class="token punctuation">}</span></code></pre>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-22T07:00:00.000Z">
    <a href="/adhd_wearables/">September 22, 2020</a>
  </time>
  <div class="postbody">
    <p>So this is pretty cool.</p>
<p><img src="/images/unicorn.jpg" alt="A wearable device to help identify decision moments."></p>
<p>Annouk Wipprecht is a fashion designer / engineer who creates wearable devices like the one above. That one in particular is interesting to me, as it focuses on helping identify moments when kids with ADHD “engage”. From <a href="https://spectrum.ieee.org/geek-life/hands-on/i-built-a-brain-computer-interface-for-tackling-adhd-in-children">a writeup on “Agent Unicorn”</a>:</p>
<blockquote>
<p>I decided to focus on what is known as the P300 event-related brain potential signal. P300 is a frequent focus of clinical exams and BCI research. It is a voltage pulse, often thought to be connected to attention and decision making, that occurs a few hundred milliseconds after an external stimulus. The P300 signal is often measured when diagnosing children with ADHD because the signal takes longer to manifest and isn’t as strong as it is in children without ADHD.</p>
<p>ADHD is commonly treated with stimulants such as Adderall that can boost concentration and focus while reducing hyperactive and impulsive behaviors. But while medication might help soothe symptoms, it doesn’t help in understanding why a child with ADHD is more prone to react to certain stimuli, or how their symptoms might be treated in a way that reduces reliance on drugs.</p>
<p>My goal was to create a device that would provide the data needed for such insights by monitoring both the brains of children and their environments. The result was Agent Unicorn—a headpiece with a projecting horn. The horn contains an 8-megapixel camera that records video during states of heightened P300 activity, as detected by an EEG built into the headpiece itself. The headpiece has a shape that automatically positions the electrodes at the correct locations on the skull.</p>
</blockquote>
<p>Here’s what it looks like when it’s going on a child:</p>
<p><img src="/images/unicorn_in_situ.jpg" alt="The device’s inventor, Annouk Wipprecht, putting the Agent Unicorn device on a child in a classroom."></p>
<p>Annouk Wipprecht has some more cool photos of her work in a gallery <a href="https://www.anoukwipprecht.nl/gallery/">on her site</a>.</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-21T07:00:00.000Z">
    <a href="/the_balancing_act/">September 21, 2020</a>
  </time>
  <div class="postbody">
    <p>In a great thread on Twitter, Kieran Snyder shares <a href="https://twitter.com/KieranSnyder/status/1308128945447944192">some great management insights</a>:</p>
<blockquote>
<p>The second mistake: Getting the balance wrong between managing up (working w your managers), managing down (working w your team), and managing over (working w your peers).</p>
<p>Most managers do one of these very well. Some do 2 out of the 3. Few get all 3 right with equal facility.</p>
<p>But all 3 of these working modes (managing up, down, and over) are important to achieving your main accountability as a manager: Delivering high-impact work on time and growing people in the process.</p>
<p>If you don’t spend enough time with your team, you fail to set accountabilities and priorities properly and you miss coaching opportunities.</p>
<p>If you don’t spend enough time with your management, you fail to set priorities properly, and you are likely missing context that can help your team. You also miss chances to be coached.</p>
<p>If you don’t spend enough time with your peers, your execution will suffer. You won’t know how your team is performing or perceived. You will lack organizational support for initiatives that matter to you.</p>
<p>At most stages of my early management career, I spent plenty of time with my team and with my management, but I didn’t spend enough time with my peers. That was an Achilles heel that I was only able to see after the fact.</p>
</blockquote>
<p>This is really insightful. I’ve talked with folks before about managers usually only being good at one, <em>maybe</em> two of “politics, product, process, or people”, but I think the look at managing up, down, and across is a great one.</p>
<p>In my last role, I nailed the “working with your team” piece, and did a really good job with the “peers” bit as well. In hindsight, that “managing up” piece was one I should have paid more attention to. Something learned for next time.</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-21T07:00:00.000Z">
    <a href="/smarter_permalinks_in_eleventy/">September 21, 2020</a>
  </time>
  <div class="postbody">
    <h1>Smarter Permalinks in Eleventy</h1>
<p>I’m continuing to enjoy Eleventy. The other day I noted that I was having trouble getting the dates to work correctly, and was hoping for some smarter autoslugging.</p>
<p>I figured out both, and wanted to share what I did.</p>
<p>I <em>had</em> been naming the date and permalink in the file’s header …</p>
<pre class="language-js"><code class="language-js"><span class="token operator">--</span><span class="token operator">-</span><br>date<span class="token operator">:</span> <span class="token string">"2020-09-21"</span><br>permalink<span class="token operator">:</span> <span class="token string">"smarter_permalinks_in_eleventy/"</span><br><span class="token operator">--</span><span class="token operator">-</span></code></pre>
<p>… but that’s duplicating the data in the filename (which was <code>2020-09-21_smarter_permalinks_in_eleventy.md</code>. This would be easier if eleventy <em>just knew</em> what the date and slug should be, right?</p>
<p>The date part was pretty easy. I removed the <code>date</code> line from the frontmatter data, and, as long as the filename had that YYYY-MM-DD formatting, it worked properly. (Thank you, eleventy, for being smart about that!) I’m still a little unsure that the UTC / PST timezones will play nicely, but it hasn’t shown to be a problem yet. (For some reason the “eleventy will automatically handle filenames with YYYY-MM-DD in them” wasn’t working for me a few days ago. Now it’s fine. ¯\_(ツ)_/¯ )</p>
<p>For the permalink, I created a new line in my <code>eleventy.js</code> file …</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"getPermalink"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token operator">=></span> page<span class="token punctuation">.</span>fileSlug<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>… and then added a line to my <code>posts/posts.json</code> file:</p>
<pre class="language-js"><code class="language-js"><span class="token string">"permalink"</span><span class="token operator">:</span> <span class="token string">"{{ page | getPermalink }}/index.html"</span><span class="token punctuation">,</span><br></code></pre>
<p>Now the data and autoslug are generated off of the file name, and my post frontmatter only needs to exist if I’m specifying the post “type” (image, quote, poem, etc.). No more duplicated data.</p>

  </div>
</article><article class="image">
  <time class="postdate" datetime="2020-09-21T07:00:00.000Z">
    <a href="/quiet_family_life/">September 21, 2020</a>
  </time>
  <div class="postbody">
    <p><img src="/images/moomin.jpg" alt="A panel of the Moomin comic, showing characters sitting around a table. The mother figure says “Isn’t this quiet family life wonderful, dear?” The father figure, looking bored, says “Yes … … … but it would be even more wonderful if something exciting and awful happened!”"></p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-20T07:00:00.000Z">
    <a href="/you_shouldve_asked/">September 20, 2020</a>
  </time>
  <div class="postbody">
    <p>This is one of my favorite comics of all time, and it only takes about five minutes to read.</p>
<p>Every time I read it, it makes me a better person and a better partner.</p>
<p><a href="https://english.emmaclit.com/2017/05/20/you-shouldve-asked/">You Should’ve Asked</a></p>

  </div>
</article><article class="quote long">
  <time class="postdate" datetime="2020-09-20T07:00:00.000Z">
    <a href="/everything/">September 20, 2020</a>
  </time>
  <div class="postbody">
    <p>Late last night, inspecting Santa’s handiwork, a simple thought occurred to me. A decade or so from now, when, say, I’m waiting for my son to come home from college for his winter break, and, when he does, he wants to spend his time going out with his friends — how much will I be willing to pay then to be able to go back in time, for one day, to now, when he’s eight years old, he wants to go to movies and play games and build Lego kits with me, and he believes in magic?</p>
<p>How much then, for one day with what my family has right now? How much? Everything.</p>
<p><a href="https://daringfireball.net/2011/12/merry">John Gruber</a></p>

  </div>
</article><article class="image">
  <time class="postdate" datetime="2020-09-19T07:00:00.000Z">
    <a href="/rbg/">September 19, 2020</a>
  </time>
  <div class="postbody">
    <img src="/images/rbg_necklace.png" alt="A picture of Ruth Bader Ginsburg’s iconic collar, but in black." style="max-width: 180px">
<p>She fought. And fought. And fought.</p>
<p>We have to do the same.</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-18T07:00:00.000Z">
    <a href="/three_days_in/">September 18, 2020</a>
  </time>
  <div class="postbody">
    <h1>Three Days In</h1>
<p>I’m three days into using <a href="https://github.com/charliepark/tumblelog/">this tumblelogging tool</a>, and am pretty happy with it. Obviously, the test is how I’ll use it over time, but things are going well so far.</p>
<h2>A few things I love</h2>
<h3>It’s great how low-stress it is</h3>
<blockquote>
<p>I don’t worry about whether things are “good enough” to post. I just post them. That’s a big improvement over what I had before, where I let the perfect be the enemy of the good, and, consequently, didn’t post.</p>
</blockquote>
<h3>The different formatting types are fun</h3>
<blockquote>
<p>I love being able to come up with new post types, and then to style them independently. For example, yesterday, when I added the “poem” type. I’ll come up with a few more, for sure. I still haven’t come up with the “link” format, but look forward to the occasion where I do.</p>
</blockquote>
<h3>Posting and hosting are both easy</h3>
<blockquote>
<p>It’s really easy to add a new post right now. Create a file with the right Markdown format and frontmatter, run <code>eleventy --serve</code> to see what it looks like, and then commit to git and push remote. (TBH, I actually just leave an iTerm window open with <code>eleventy --serve</code> going all the time.)</p>
</blockquote>
<blockquote>
<p>The workflow is a little dependent on VS Code, where I’m writing these, and running eleventy on my local machine. And I have a few ideas around requiring less of the template in the Markdown file that I need to play with. But it’s working for now.</p>
</blockquote>
<h2>Some things to work on</h2>
<h3>Less metawork</h3>
<aside class="callout_box">
  <p><b>Update:</b> I’ve fixed this now! See here for more: <a href="/smarter_permalinks_in_eleventy">Smarter Permalinks in Eleventy</a></p>
</aside>
<blockquote>
<p>Right now I have a bit of duplication of effort, in that I name the file something like <code>2020_09_18_three_days_in.md</code> and then add metadata like</p>
</blockquote>
<pre class="language-text"><code class="language-text">---<br>date: "2020-09-18"<br>permalink: "three_days_in/"<br>---</code></pre>
<blockquote>
<p>The eleventy docs say that it’ll use any YYYY-MM-DD in the file name as a date, but I haven’t found that to be the case (I know my date in the filename is using underscores; even when using dashes it doesn’t seem to quite work). It’d be nice to add something to the compiler / preferences that interpreted the filename correctly and then just used it for the date and permalink. Perhaps there’s a way to configure that, and I just haven’t found it yet.</p>
</blockquote>
<h3>Mmmmmaybe a posting interface?</h3>
<blockquote>
<p>I can imagine a Svelte app that gives an easy posting input. Name the permalink, adjust the date if needed (but default to now), and give an input field for posting the content. Write the .md file on submission, then run <code>eleventy</code> to process it. At that point, you could just add a button that pushes it to GitHub as well. That’d be pretty cool.</p>
</blockquote>
<h3>RSS, or posting to Twitter, etc.</h3>
<blockquote>
<p>Right now, hardly anybody knows about this tumblelog, and that’s fine. (Hi, folks who are here!) But I could see it being useful to have some sort of “push this content to Twitter”. I’m not sure how that works with eleventy, and it’s possible there isn’t a convenient hook to do that. But it’d be cool to have that as an option. Maybe it’d be another bit of metadata in the header — if <code>post_to_twitter: true</code>, push it.</p>
</blockquote>
<h3>Social?</h3>
<blockquote>
<p>I’ve realized that one of the things that Tumblr did well was to give you a place to both create and consume. Twitter, too. Right now, this is just a place where I publish stuff. If I ever decide to make this more of a thing, it’d be helpful to have a place where I can read other people’s stuff, too. (I’ve always wondered why RSS readers don’t also give you a way to publish your own stuff. [Or maybe they do! Dunno!])</p>
</blockquote>
<h3>Separating <em>my</em> instance of this from the tool to let you do it yourself</h3>
<blockquote>
<p>When I wrote my two-times-ago blog, in Jekyll, a lot of people cloned it on GitHub, I believe to help them with a tagging issue that I solved. The problem was that I began to get worried about changing my blog (because it might mess up other peoples’ stuff?). That’s kind of silly. But if I ever do make this a more general-purpose tool for folks, I’ll want to figure out the best way to split them up. Very do-able; I just haven’t had to think through that piece yet.</p>
</blockquote>
<h2>So.</h2>
<p>So that’s where things are right now. It’s still fun, and I’m enjoying it. And I have a few clear ”next thing to work on”s.</p>
<p>If you have any feedback, let me know! My DMs on Twitter (@charliepark) are open, though I’m on a bit of a Twitter break at the moment. Nevertheless, say hi!</p>

  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-17T07:00:00.000Z">
    <a href="/the_big_one/">September 17, 2020</a>
  </time>
  <div class="postbody">
    <h1>There are fires during wartime, too.</h1>
<p>There’s a scene in the film <em>Hope and Glory</em> that I think about a lot. Thirty seconds of DDGing haven’t brought up either a clip or a quote, so you’ll have to take my word for what goes on in the scene.</p>
<p>The film takes place during World War II, in London. Some of the more exciting bits of the film take place during air raids, where German planes drop carpet bombs on the city.</p>
<p>One night, the family’s out, at a play, or something. They return home, and their house is completely engulfed in flames.</p>
<p>The mother, horror-struck, turns to the fire chief. “But I didn’t hear the air raid sirens!”</p>
<p>“There wasn’t an air raid, Ma’am.”</p>
<p>“But the fire?!”</p>
<p>“There are fires during wartime too, Ma’am.”</p>
<p>There are fires during wartime, too.</p>
<p>It’s tempting — in the middle of a global pandemic AND historic wildfires AND an impending consitutional crisis — to say “Well, damn. It can’t get worse, right?”</p>
<p>Here’s the thing. Geology doesn’t care about any of that, and we’re just as likely to have a major earthquake during a global pandemic as we are at any other time. The odds haven’t improved just because everything else has gotten terrible.</p>
<p>If you live in California, I highly recommend the following podcast. It’s nine episodes, each a little over half an hour, produced by KPCC, Southern California Public Radio. It’s sobering, and could save your life.</p>
<iframe src="https://open.spotify.com/embed-podcast/show/3yaIsM9h6jPJn9d2FRNKVe" width="100%" height="232" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
<p>Also, connect with your local CERT / <a href="https://sf-fire.org/neighborhood-emergency-response-team-nert">NERT</a> group and get trained!</p>

  </div>
</article><article class="poem">
  <time class="postdate" datetime="2020-09-17T07:00:00.000Z">
    <a href="/egg/">September 17, 2020</a>
  </time>
  <div class="postbody">
    <h1>Egg</h1>
<p>by C.G. Hanzlicek</p>
<p>I’m scrambling an egg for my daughter.<br />
“Why are you always whistling?” she asks.<br />
“Because I’m happy.”<br />
And it’s true,<br />
Though it stuns me to say it aloud;<br />
There was a time when I wouldn’t<br />
Have seen it as my future.<br />
It’s partly a matter<br />
Of who is there to eat the egg:<br />
The self fallen out of love with itself<br />
Through the tedium of familiarity,<br />
Or this little self,<br />
So curious, so hungry,<br />
Who emerged from the woman I love,<br />
A woman who loves me in a way<br />
I’ve come to think I deserve,<br />
Now that it arrives from outside me.<br />
Everything changes, we’re told,<br />
And now the changes are everywhere:<br />
The house with its morning light<br />
That fills me like a revelation,<br />
The yard with its trees<br />
That cast a bit more shade each summer,<br />
The love of a woman<br />
That both is and isn’t confounding,<br />
And the love<br />
Of this clamor of questions at my waist.<br />
Clamor of questions,<br />
You clamor of answers,<br />
Here’s your egg.<br /></p>

  </div>
</article><article class="quote long">
  <time class="postdate" datetime="2020-09-16T07:00:00.000Z">
    <a href="/the_familiar_and_the_new/">September 16, 2020</a>
  </time>
  <div class="postbody">
    <p>One of my philosophies as a designer is that you should first start with the patterns that exist, and only break the rules little by little, in the right places. When [you] don’t break enough patterns, you end up with something boring and predictable. But when you break too many, you end up with something chaotic and confusing. There is a sweet spot, and it contains both the familiar and the new.</p>
<p>Jack Cheng (<a href="https://www.kickstarter.com/projects/jackcheng/these-days-a-novel/posts/347012">here</a>, though post is only available to Kickstarter backers)</p>

  </div>
</article><article class="image">
  <time class="postdate" datetime="2020-09-15T07:00:00.000Z">
    <a href="/the_library/">September 15, 2020</a>
  </time>
  <div class="postbody">
    <p><img src="/images/the_library_a_great_place_to_get_checked_out.jpg" alt="The Library: A good place to get checked out."></p>

  </div>
</article><article class="video">
  <time class="postdate" datetime="2020-09-15T07:00:00.000Z">
    <a href="/september_15/">September 15, 2020</a>
  </time>
  <div class="postbody">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/n2nI60dpQg0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>It being September 15th, we remember four little girls from Birmingham — Addie Mae Collins, Cynthia Wesley, Carole Robertson, Carol Denise McNair — and twenty years later, a man from Spanish Town, Prince Far I.</p>
  </div>
</article><article class="text">
  <time class="postdate" datetime="2020-09-15T07:00:00.000Z">
    <a href="/hello_tumblelog/">September 15, 2020</a>
  </time>
  <div class="postbody">
    <h1>Hello, tumblelog</h1>
<p>This is just a quick afternoon project I threw together, to play a bit more with Eleventy (<a href="https://www.11ty.dev/">11ty</a>) and <a href="http://netlify.com/">Netlify</a>.</p>
<p>The goal was to create a very basic tumblelog, which most of the world knew as “the kind of microblog that Tumblr made”. Which isn’t <em>wrong</em>. But there were tumblelogs before Tumblr, and, I guess, after Tumblr as well.</p>
<p>I think I’ve been hesitant to do much with my main website because … it feels like my homepage should be SeRiOuS. Which, yeah, maybe. But it’s also kind of dead right now.</p>
<p>So! I’m going to try this out and see if it works. If it does, I’ll look into moving my main blog over to this.</p>
<p>Development went pretty well. I’ve built a few things with Eleventy before. I have to say, every time I start fresh with it I have to wrestle with the docs a fair amount. A lot of it’s really straightforward and clear. But something as basic as “how do I post a copy of each post’s content on the main page?” is somehow hard to search for. (The answer, by the way, is something like this:</p>
<pre class="language-html"><code class="language-html">{%- for post in collections.all | reverse -%}<br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ post | setClasses }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>{%- if post.data.date %}<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>time</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>postdate<span class="token punctuation">"</span></span> <span class="token attr-name">datetime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ post.data.date | getISOString }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{ post.url }}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{ post.data.date | getHumanDate }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>time</span><span class="token punctuation">></span></span><br>{%- endif %}<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>postbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    {{ post.templateContent | safe }}<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span><br>{%- endfor -%}<br></code></pre>
<p>Oh! And that datetime format is handled like this, in your eleventy config file:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">setDateToMidnight</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">getISOString</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> midnight <span class="token operator">=</span> <span class="token function">setDateToMidnight</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>midnight<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token function-variable function">getHumanDate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> midnight <span class="token operator">=</span> <span class="token function">setDateToMidnight</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>midnight<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token string">‘en-us’</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    month<span class="token operator">:</span> <span class="token string">‘long’</span><span class="token punctuation">,</span><br>    day<span class="token operator">:</span> <span class="token string">‘numeric’</span><span class="token punctuation">,</span><br>    year<span class="token operator">:</span> <span class="token string">‘numeric’</span><span class="token punctuation">,</span><br>    timeZone<span class="token operator">:</span> <span class="token string">‘UTC’</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">eleventyConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"getHumanDate"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">getHumanDate</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  eleventyConfig<span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span><span class="token string">"getISOString"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">getISOString</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Note the <code>timeZone: ‘UTC’</code> bit in the <code>toLocaleString()</code> options! It’s pretty important!</p>

  </div>
</article>
  </main>
  <footer>
    <p>Hey there. I’m Charlie. I like adventures, friends, and adventures with friends.</p>
    <p>Would love for you to say hi! charlie@charliepark.org</p>
  </footer>
</body>
</html>

